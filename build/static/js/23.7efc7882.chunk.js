(this.webpackJsonpreact_admin_dashboard=this.webpackJsonpreact_admin_dashboard||[]).push([[23],{353:function(e,t,a){"use strict";a.r(t);var n=a(57),r=a(17),s=a(18),o=a(25),i=a(24),u=a(0),c=a.n(u),l=a(1),d=a(9),p=a(356),h=a(348),m=a(358),f=a(354),g=a(352),v=a(10),b=a(349),E={url:{API_BASE_URL:"https://myapp.herokuapp.com"}};function I(e){if(e){var t=e.split(".")[1].replace("-","+").replace("_","/");return JSON.parse(window.atob(t))}}var w=function(e){e.response?console.log(e.response.data):e.request?console.log(e.request):console.log(e.message)},A={authenticate:function(e,t){return O.post("/auth/authenticate",{username:e,password:t},{headers:{"Content-type":"application/json"}})},signup:function(e){return O.post("/auth/signup",e,{headers:{"Content-type":"application/json"}})},numberOfUsers:function(){return O.get("/public/numberOfUsers")},numberOfOrders:function(){return O.get("/public/numberOfOrders")},getUsers:function(e,t){var a=t?"/api/users/".concat(t):"/api/users";return O.get(a,{headers:{Authorization:C(e)}})},deleteUser:function(e,t){return O.delete("/api/users/".concat(t),{headers:{Authorization:C(e)}})},getOrders:function(e,t){var a=t?"/api/orders?text=".concat(t):"/api/orders";return O.get(a,{headers:{Authorization:C(e)}})},deleteOrder:function(e,t){return O.delete("/api/orders/".concat(t),{headers:{Authorization:C(e)}})},createOrder:function(e,t){return O.post("/api/orders",t,{headers:{"Content-type":"application/json",Authorization:C(e)}})},getUserMe:function(e){return O.get("/api/users/me",{headers:{Authorization:C(e)}})}};var O=b.a.create({baseURL:E.url.API_BASE_URL});function C(e){return"Bearer ".concat(e.accessToken)}O.interceptors.request.use((function(e){if(e.headers.Authorization){var t=I(e.headers.Authorization.split(" ")[1]);Date.now()>1e3*t.exp&&(window.location.href="/login")}return e}),(function(e){return Promise.reject(e)}));var y=function(e){Object(o.a)(a,e);var t=Object(i.a)(a);function a(){var e;Object(r.a)(this,a);for(var s=arguments.length,o=new Array(s),i=0;i<s;i++)o[i]=arguments[i];return(e=t.call.apply(t,[this].concat(o))).state={username:"",password:"",name:"",email:"",isLoggedIn:!1,isError:!1,errorMessage:""},e.handleInputChange=function(t,a){var r=a.name,s=a.value;e.setState(Object(n.a)({},r,s))},e.handleSubmit=function(t){t.preventDefault();var a=e.state,n=a.username,r=a.password,s=a.name,o=a.email;if(n&&r&&s&&o){var i={username:n,password:r,name:s,email:o};A.signup(i).then((function(t){var a=t.data.accessToken,n={data:I(a),accessToken:a};e.context.userLogin(n),e.setState({username:"",password:"",isLoggedIn:!0,isError:!1,errorMessage:""})})).catch((function(t){if(w(t),t.response&&t.response.data){var a=t.response.data,n="Invalid fields";409===a.status?n=a.message:400===a.status&&(n=a.errors[0].defaultMessage),e.setState({isError:!0,errorMessage:n})}}))}else e.setState({isError:!0,errorMessage:"Please, inform all fields!"})},e}return Object(s.a)(a,[{key:"componentDidMount",value:function(){var e=this.context.userIsAuthenticated();this.setState({isLoggedIn:e})}},{key:"render",value:function(){var e=this.state,t=e.isLoggedIn,a=e.isError,n=e.errorMessage;return t?c.a.createElement(l.a,{to:"/app"}):c.a.createElement(p.a,{textAlign:"center"},c.a.createElement(p.a.Column,{style:{maxWidth:450}},c.a.createElement(h.a,{size:"large",onSubmit:this.handleSubmit},c.a.createElement(m.a,null,c.a.createElement(h.a.Input,{fluid:!0,autoFocus:!0,name:"username",icon:"user",iconPosition:"left",placeholder:"Username",onChange:this.handleInputChange}),c.a.createElement(h.a.Input,{fluid:!0,name:"password",icon:"lock",iconPosition:"left",placeholder:"Password",type:"password",onChange:this.handleInputChange}),c.a.createElement(h.a.Input,{fluid:!0,name:"name",icon:"address card",iconPosition:"left",placeholder:"Name",onChange:this.handleInputChange}),c.a.createElement(h.a.Input,{fluid:!0,name:"email",icon:"at",iconPosition:"left",placeholder:"Email",onChange:this.handleInputChange}),c.a.createElement(f.a,{color:"violet",fluid:!0,size:"large"},"Signup"))),c.a.createElement(g.a,null,"Already have an account? ",c.a.createElement("a",{href:"/login",color:"violet",as:d.c,to:"/login"},"Login")),a&&c.a.createElement(g.a,{negative:!0},n)))}}]),a}(u.Component);y.contextType=v.b;t.default=y}}]);
//# sourceMappingURL=23.7efc7882.chunk.js.map