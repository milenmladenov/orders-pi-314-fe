{"ast":null,"code":"import axios from'axios';import{config}from'../../Constants';import{parseJwt}from'./Helpers';export var orderApi={authenticate:authenticate,signup:signup,numberOfUsers:numberOfUsers,numberOfOrders:numberOfOrders,getUsers:getUsers,deleteUser:deleteUser,getOrders:getOrders,deleteOrder:deleteOrder,createOrder:createOrder,getUserMe:getUserMe};function authenticate(username,password){return instance.post('/auth/authenticate',{username:username,password:password},{headers:{'Content-type':'application/json'}});}function signup(user){return instance.post('/auth/signup',user,{headers:{'Content-type':'application/json'}});}function numberOfUsers(){return instance.get('/public/numberOfUsers');}function numberOfOrders(){return instance.get('/public/numberOfOrders');}function getUsers(user,username){var url=username?\"/api/users/\".concat(username):'/api/users';return instance.get(url,{headers:{'Authorization':bearerAuth(user)}});}function deleteUser(user,username){return instance.delete(\"/api/users/\".concat(username),{headers:{'Authorization':bearerAuth(user)}});}function getOrders(user,text){var url=text?\"/api/orders?text=\".concat(text):'/api/orders';return instance.get(url,{headers:{'Authorization':bearerAuth(user)}});}function deleteOrder(user,orderId){return instance.delete(\"/api/orders/\".concat(orderId),{headers:{'Authorization':bearerAuth(user)}});}function createOrder(user,order){return instance.post('/api/orders',order,{headers:{'Content-type':'application/json','Authorization':bearerAuth(user)}});}function getUserMe(user){return instance.get('/api/users/me',{headers:{'Authorization':bearerAuth(user)}});}// -- Axios\nvar instance=axios.create({baseURL:config.url.API_BASE_URL});instance.interceptors.request.use(function(config){// If token is expired, redirect user to login\nif(config.headers.Authorization){var token=config.headers.Authorization.split(' ')[1];var data=parseJwt(token);if(Date.now()>data.exp*1000){window.location.href=\"/login\";}}return config;},function(error){return Promise.reject(error);});// -- Helper functions\nfunction bearerAuth(user){return\"Bearer \".concat(user.accessToken);}","map":{"version":3,"names":["axios","config","parseJwt","orderApi","authenticate","signup","numberOfUsers","numberOfOrders","getUsers","deleteUser","getOrders","deleteOrder","createOrder","getUserMe","username","password","instance","post","headers","user","get","url","concat","bearerAuth","delete","text","orderId","order","create","baseURL","API_BASE_URL","interceptors","request","use","Authorization","token","split","data","Date","now","exp","window","location","href","error","Promise","reject","accessToken"],"sources":["/Users/milenmladenov/asset-management-fe/src/components/misc/OrderApi.js"],"sourcesContent":["import axios from 'axios'\nimport { config } from '../../Constants'\nimport { parseJwt } from './Helpers'\n\nexport const orderApi = {\n  authenticate,\n  signup,\n  numberOfUsers,\n  numberOfOrders,\n  getUsers,\n  deleteUser,\n  getOrders,\n  deleteOrder,\n  createOrder,\n  getUserMe\n}\n\nfunction authenticate(username, password) {\n  return instance.post('/auth/authenticate', { username, password }, {\n    headers: { 'Content-type': 'application/json' }\n  })\n}\n\nfunction signup(user) {\n  return instance.post('/auth/signup', user, {\n    headers: { 'Content-type': 'application/json' }\n  })\n}\n\nfunction numberOfUsers() {\n  return instance.get('/public/numberOfUsers')\n}\n\nfunction numberOfOrders() {\n  return instance.get('/public/numberOfOrders')\n}\n\nfunction getUsers(user, username) {\n  const url = username ? `/api/users/${username}` : '/api/users'\n  return instance.get(url, {\n    headers: { 'Authorization': bearerAuth(user) }\n  })\n}\n\nfunction deleteUser(user, username) {\n  return instance.delete(`/api/users/${username}`, {\n    headers: { 'Authorization': bearerAuth(user) }\n  })\n}\n\nfunction getOrders(user, text) {\n  const url = text ? `/api/orders?text=${text}` : '/api/orders'\n  return instance.get(url, {\n    headers: { 'Authorization': bearerAuth(user) }\n  })\n}\n\nfunction deleteOrder(user, orderId) {\n  return instance.delete(`/api/orders/${orderId}`, {\n    headers: { 'Authorization': bearerAuth(user) }\n  })\n}\n\nfunction createOrder(user, order) {\n  return instance.post('/api/orders', order, {\n    headers: {\n      'Content-type': 'application/json',\n      'Authorization': bearerAuth(user)\n    }\n  })\n}\n\nfunction getUserMe(user) {\n  return instance.get('/api/users/me', {\n    headers: { 'Authorization': bearerAuth(user) }\n  })\n}\n\n// -- Axios\n\nconst instance = axios.create({\n  baseURL: config.url.API_BASE_URL\n})\n\ninstance.interceptors.request.use(function (config) {\n  // If token is expired, redirect user to login\n  if (config.headers.Authorization) {\n    const token = config.headers.Authorization.split(' ')[1]\n    const data = parseJwt(token)\n    if (Date.now() > data.exp * 1000) {\n      window.location.href = \"/login\"\n    }\n  }\n  return config\n}, function (error) {\n  return Promise.reject(error)\n})\n\n// -- Helper functions\n\nfunction bearerAuth(user) {\n  return `Bearer ${user.accessToken}`\n}"],"mappings":"AAAA,MAAO,CAAAA,KAAK,KAAM,OAAO,CACzB,OAASC,MAAM,KAAQ,iBAAiB,CACxC,OAASC,QAAQ,KAAQ,WAAW,CAEpC,MAAO,IAAM,CAAAC,QAAQ,CAAG,CACtBC,YAAY,CAAZA,YAAY,CACZC,MAAM,CAANA,MAAM,CACNC,aAAa,CAAbA,aAAa,CACbC,cAAc,CAAdA,cAAc,CACdC,QAAQ,CAARA,QAAQ,CACRC,UAAU,CAAVA,UAAU,CACVC,SAAS,CAATA,SAAS,CACTC,WAAW,CAAXA,WAAW,CACXC,WAAW,CAAXA,WAAW,CACXC,SAAS,CAATA,SACF,CAAC,CAED,QAAS,CAAAT,YAAYA,CAACU,QAAQ,CAAEC,QAAQ,CAAE,CACxC,MAAO,CAAAC,QAAQ,CAACC,IAAI,CAAC,oBAAoB,CAAE,CAAEH,QAAQ,CAARA,QAAQ,CAAEC,QAAQ,CAARA,QAAS,CAAC,CAAE,CACjEG,OAAO,CAAE,CAAE,cAAc,CAAE,kBAAmB,CAChD,CAAC,CAAC,CACJ,CAEA,QAAS,CAAAb,MAAMA,CAACc,IAAI,CAAE,CACpB,MAAO,CAAAH,QAAQ,CAACC,IAAI,CAAC,cAAc,CAAEE,IAAI,CAAE,CACzCD,OAAO,CAAE,CAAE,cAAc,CAAE,kBAAmB,CAChD,CAAC,CAAC,CACJ,CAEA,QAAS,CAAAZ,aAAaA,CAAA,CAAG,CACvB,MAAO,CAAAU,QAAQ,CAACI,GAAG,CAAC,uBAAuB,CAAC,CAC9C,CAEA,QAAS,CAAAb,cAAcA,CAAA,CAAG,CACxB,MAAO,CAAAS,QAAQ,CAACI,GAAG,CAAC,wBAAwB,CAAC,CAC/C,CAEA,QAAS,CAAAZ,QAAQA,CAACW,IAAI,CAAEL,QAAQ,CAAE,CAChC,GAAM,CAAAO,GAAG,CAAGP,QAAQ,eAAAQ,MAAA,CAAiBR,QAAQ,EAAK,YAAY,CAC9D,MAAO,CAAAE,QAAQ,CAACI,GAAG,CAACC,GAAG,CAAE,CACvBH,OAAO,CAAE,CAAE,eAAe,CAAEK,UAAU,CAACJ,IAAI,CAAE,CAC/C,CAAC,CAAC,CACJ,CAEA,QAAS,CAAAV,UAAUA,CAACU,IAAI,CAAEL,QAAQ,CAAE,CAClC,MAAO,CAAAE,QAAQ,CAACQ,MAAM,eAAAF,MAAA,CAAeR,QAAQ,EAAI,CAC/CI,OAAO,CAAE,CAAE,eAAe,CAAEK,UAAU,CAACJ,IAAI,CAAE,CAC/C,CAAC,CAAC,CACJ,CAEA,QAAS,CAAAT,SAASA,CAACS,IAAI,CAAEM,IAAI,CAAE,CAC7B,GAAM,CAAAJ,GAAG,CAAGI,IAAI,qBAAAH,MAAA,CAAuBG,IAAI,EAAK,aAAa,CAC7D,MAAO,CAAAT,QAAQ,CAACI,GAAG,CAACC,GAAG,CAAE,CACvBH,OAAO,CAAE,CAAE,eAAe,CAAEK,UAAU,CAACJ,IAAI,CAAE,CAC/C,CAAC,CAAC,CACJ,CAEA,QAAS,CAAAR,WAAWA,CAACQ,IAAI,CAAEO,OAAO,CAAE,CAClC,MAAO,CAAAV,QAAQ,CAACQ,MAAM,gBAAAF,MAAA,CAAgBI,OAAO,EAAI,CAC/CR,OAAO,CAAE,CAAE,eAAe,CAAEK,UAAU,CAACJ,IAAI,CAAE,CAC/C,CAAC,CAAC,CACJ,CAEA,QAAS,CAAAP,WAAWA,CAACO,IAAI,CAAEQ,KAAK,CAAE,CAChC,MAAO,CAAAX,QAAQ,CAACC,IAAI,CAAC,aAAa,CAAEU,KAAK,CAAE,CACzCT,OAAO,CAAE,CACP,cAAc,CAAE,kBAAkB,CAClC,eAAe,CAAEK,UAAU,CAACJ,IAAI,CAClC,CACF,CAAC,CAAC,CACJ,CAEA,QAAS,CAAAN,SAASA,CAACM,IAAI,CAAE,CACvB,MAAO,CAAAH,QAAQ,CAACI,GAAG,CAAC,eAAe,CAAE,CACnCF,OAAO,CAAE,CAAE,eAAe,CAAEK,UAAU,CAACJ,IAAI,CAAE,CAC/C,CAAC,CAAC,CACJ,CAEA;AAEA,GAAM,CAAAH,QAAQ,CAAGhB,KAAK,CAAC4B,MAAM,CAAC,CAC5BC,OAAO,CAAE5B,MAAM,CAACoB,GAAG,CAACS,YACtB,CAAC,CAAC,CAEFd,QAAQ,CAACe,YAAY,CAACC,OAAO,CAACC,GAAG,CAAC,SAAUhC,MAAM,CAAE,CAClD;AACA,GAAIA,MAAM,CAACiB,OAAO,CAACgB,aAAa,CAAE,CAChC,GAAM,CAAAC,KAAK,CAAGlC,MAAM,CAACiB,OAAO,CAACgB,aAAa,CAACE,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CACxD,GAAM,CAAAC,IAAI,CAAGnC,QAAQ,CAACiC,KAAK,CAAC,CAC5B,GAAIG,IAAI,CAACC,GAAG,CAAC,CAAC,CAAGF,IAAI,CAACG,GAAG,CAAG,IAAI,CAAE,CAChCC,MAAM,CAACC,QAAQ,CAACC,IAAI,CAAG,QAAQ,CACjC,CACF,CACA,MAAO,CAAA1C,MAAM,CACf,CAAC,CAAE,SAAU2C,KAAK,CAAE,CAClB,MAAO,CAAAC,OAAO,CAACC,MAAM,CAACF,KAAK,CAAC,CAC9B,CAAC,CAAC,CAEF;AAEA,QAAS,CAAArB,UAAUA,CAACJ,IAAI,CAAE,CACxB,gBAAAG,MAAA,CAAiBH,IAAI,CAAC4B,WAAW,EACnC"},"metadata":{},"sourceType":"module"}