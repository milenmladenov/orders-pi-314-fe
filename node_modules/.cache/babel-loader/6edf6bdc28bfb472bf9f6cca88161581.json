{"ast":null,"code":"import axios from'axios';import{config}from'../../Constants';import{parseJwt}from'./Helpers';export var orderApi={authenticate:authenticate,signup:signup,numberOfUsers:numberOfUsers,numberOfOrders:numberOfOrders,getUsers:getUsers,deleteUser:deleteUser,getOrders:getOrders,deleteOrder:deleteOrder,createOrder:createOrder,getUserMe:getUserMe,newOrder:newOrder};function authenticate(username,password){return instance.post('/auth/authenticate',{username:username,password:password},{headers:{'Content-type':'application/json'}});}function signup(user){return instance.post('/auth/signup',user,{headers:{'Content-type':'application/json'}});}function numberOfUsers(){return instance.get('/public/numberOfUsers');}function numberOfOrders(){return instance.get('/public/numberOfOrders');}function getUsers(user,username){var url=username?\"/api/users/\".concat(username):'/api/users';return instance.get(url,{headers:{'Authorization':bearerAuth(user)}});}function deleteUser(user,username){return instance.delete(\"/api/users/\".concat(username),{headers:{'Authorization':bearerAuth(user)}});}function newOrder(user){console.log(user.accessToken);return instance.post(\"api/orders/new-order\",{headers:{'Content-type':'application/json','Authorization':bearerAuth(user)}});}function getOrders(user,text){var url=text?\"/api/orders?text=\".concat(text):'/api/orders';return instance.get(url,{headers:{'Authorization':bearerAuth(user)}});}function deleteOrder(user,orderId){return instance.delete(\"/api/orders/\".concat(orderId),{headers:{'Authorization':bearerAuth(user)}});}function createOrder(user,order){return instance.post('/api/orders',order,{headers:{'Content-type':'application/json','Authorization':bearerAuth(user)}});}function getUserMe(user){return instance.get('/api/users/me',{headers:{'Authorization':bearerAuth(user)}});}// -- Axios\nvar instance=axios.create({baseURL:config.url.API_BASE_URL});instance.interceptors.request.use(function(config){// If token is expired, redirect user to login\nif(config.headers.Authorization){var token=config.headers.Authorization.split(' ')[1];var data=parseJwt(token);if(Date.now()>data.exp*1000){window.location.href=\"/login\";}}return config;},function(error){return Promise.reject(error);});// -- Helper functions\nfunction bearerAuth(user){return\"Bearer \".concat(user.accessToken);}","map":{"version":3,"names":["axios","config","parseJwt","orderApi","authenticate","signup","numberOfUsers","numberOfOrders","getUsers","deleteUser","getOrders","deleteOrder","createOrder","getUserMe","newOrder","username","password","instance","post","headers","user","get","url","concat","bearerAuth","delete","console","log","accessToken","text","orderId","order","create","baseURL","API_BASE_URL","interceptors","request","use","Authorization","token","split","data","Date","now","exp","window","location","href","error","Promise","reject"],"sources":["/Users/milenmladenov/asset-management-fe/src/components/misc/OrderApi.js"],"sourcesContent":["import axios from 'axios'\nimport { config } from '../../Constants'\nimport { parseJwt } from './Helpers'\n\nexport const orderApi = {\n    authenticate,\n    signup,\n    numberOfUsers,\n    numberOfOrders,\n    getUsers,\n    deleteUser,\n    getOrders,\n    deleteOrder,\n    createOrder,\n    getUserMe,\n    newOrder\n}\n\nfunction authenticate(username, password) {\n    return instance.post('/auth/authenticate', { username, password }, {\n        headers: { 'Content-type': 'application/json' }\n    })\n}\n\nfunction signup(user) {\n    return instance.post('/auth/signup', user, {\n        headers: { 'Content-type': 'application/json' }\n    })\n}\n\nfunction numberOfUsers() {\n    return instance.get('/public/numberOfUsers')\n}\n\nfunction numberOfOrders() {\n    return instance.get('/public/numberOfOrders')\n}\n\nfunction getUsers(user, username) {\n    const url = username ? `/api/users/${username}` : '/api/users'\n    return instance.get(url, {\n        headers: { 'Authorization': bearerAuth(user) }\n    })\n}\n\nfunction deleteUser(user, username) {\n    return instance.delete(`/api/users/${username}`, {\n        headers: { 'Authorization': bearerAuth(user) }\n    })\n}\nfunction newOrder(user) {\n    console.log(user.accessToken)\n    return instance.post(`api/orders/new-order`, {\n\n        headers: { 'Content-type': 'application/json', 'Authorization': bearerAuth(user) }\n    })\n}\n\nfunction getOrders(user, text) {\n    const url = text ? `/api/orders?text=${text}` : '/api/orders'\n    return instance.get(url, {\n        headers: { 'Authorization': bearerAuth(user) }\n    })\n}\n\nfunction deleteOrder(user, orderId) {\n    return instance.delete(`/api/orders/${orderId}`, {\n        headers: { 'Authorization': bearerAuth(user) }\n    })\n}\n\nfunction createOrder(user, order) {\n    return instance.post('/api/orders', order, {\n        headers: {\n            'Content-type': 'application/json',\n            'Authorization': bearerAuth(user)\n        }\n    })\n}\n\nfunction getUserMe(user) {\n    return instance.get('/api/users/me', {\n        headers: { 'Authorization': bearerAuth(user) }\n    })\n}\n\n// -- Axios\n\nconst instance = axios.create({\n    baseURL: config.url.API_BASE_URL\n})\n\ninstance.interceptors.request.use(function (config) {\n    // If token is expired, redirect user to login\n    if (config.headers.Authorization) {\n        const token = config.headers.Authorization.split(' ')[1]\n        const data = parseJwt(token)\n        if (Date.now() > data.exp * 1000) {\n            window.location.href = \"/login\"\n        }\n    }\n    return config\n}, function (error) {\n    return Promise.reject(error)\n})\n\n// -- Helper functions\n\nfunction bearerAuth(user) {\n    return `Bearer ${user.accessToken}`\n}"],"mappings":"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"},"metadata":{},"sourceType":"module"}