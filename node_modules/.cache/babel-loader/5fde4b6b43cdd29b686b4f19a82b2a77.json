{"ast":null,"code":"require('node-zip');\nvar fs = require('fs');\nDate.prototype.getJulian = function () {\n  return Math.floor(this / 86400000 - this.getTimezoneOffset() / 1440 + 2440587.5);\n};\nDate.prototype.oaDate = function () {\n  return (this - new Date(Date.UTC(1899, 11, 30))) / (24 * 60 * 60 * 1000);\n};\nvar templateXLSX = \"UEsDBBQAAAAIABN7eUK9Z10uOQEAADUEAAATAAAAW0NvbnRlbnRfVHlwZXNdLnhtbK2US04DMQyGrzLKFk1SWCCEOu0C2EIluECUeDpR81LslvZsLDgSV8CdQQVViALtJlFi+//+PN9eXsfTdfDVCgq6FBtxLkeigmiSdXHeiCW19ZWYTsZPmwxYcWrERnRE+VopNB0EjTJliBxpUwmaeFjmKmuz0HNQF6PRpTIpEkSqaashJuNbaPXSU3W35ukBy+WiuhnytqhG6Jy9M5o4rFbR7kHq1LbOgE1mGbhEYi6gLXYAFLzsexm0i2e9sPqWWcDj36Afq5Jc2edg5zL+hMgYrMn/g5hUoM6Fo4UcfGIe+KyKs1DNdKF7HVhR8T7MOBMVa8tj9xK2/i3Y38LXXmGnC9hHKnxp8GgD+4f5RfugEdp4OLmDXvQQ+jmVRV+Barh/pzWxkz/kg/hRwtAebaFX2QFV/wlM3gFQSwMEFAAAAAgAE3t5QnSZgAMeAQAAnAIAAAsAAABfcmVscy8ucmVsc7WSQW7DIBBFr4LYxxib1E4VJ5tusquiXGAMg2PFBgQkdc/WRY/UKxRVrZpUiVSp6hKY//RmhreX1+V6GgdyQh96axrKs5wSNNKq3nQNPUY9q+l6tdziADFVhH3vAkkRExq6j9HdMxbkHkcImXVo0ou2foSYjr5jDuQBOmRFnt8xf86gl0yye3b4G6LVupf4YOVxRBOvgH9UULID32FsKJsG9mT9obX2kCUqJRvV0K0AKIq25MChEsWCU8L+TQ2niEahmjmf8j72GM78lJWP6T4wcO5b0G/UH5xuL4CNGEFBBCatx+tGX+mA/pRau51hKLVSJRelLrioF/liDkLIinM+b6uibDMXRiXd58xRi7qSJeayEgLq6qM/dvHHVu9QSwMEFAAAAAgAE3t5Qu9e315hAQAAPQMAABAAAABkb2NQcm9wcy9hcHAueG1snZNNTsMwEIWvYrxv3ZYKoShxVQESGyCiFSyRcSatRWJb9jRquRoLjsQVcBIoafkRsBvPfJl570l5eXqOJ+uyIBU4r4xO6LA/oAS0NJnSi4SuMO8d0wmPhY1SZyw4VOBJ+ET7qMKELhFtxJiXSyiF7wdCh2FuXCkwPN2CmTxXEk6NXJWgkY0GgyOWGVlv8zfzjQVP3/YJ+999sEbQGWQ9u9VIG81TawslBQZv/EJJZ7zJkZytJRQx25vXfFg7A7lyCjd80BDdTk3MpCjgJJzhuSg8NMxHrybOQdThpUI5z+MKowokGkfuhYfab0Ir4ZTQSIlXj+E5pi3Wdpu6sB4dvzXuwS8B0Mds22zKLtut1ZgPGyAUP4LtrktRQkauhV7AX06Mvj7Btl55E8tuEKExV1iAv8pT4fCbaBoB78Ec0o7WWR0EGXZl7s8OUqc03k0diF9grZpPtjsG9vSynZ+AvwJQSwMEFAAAAAAAxYV5QgAAAAAAAAAAAAAAABEAAABwYWNrYWdlL3NlcnZpY2VzL1BLAwQUAAAAAADFhXlCAAAAAAAAAAAAAAAAGgAAAHBhY2thZ2Uvc2VydmljZXMvbWV0YWRhdGEvUEsDBBQAAAAAAMWFeUIAAAAAAAAAAAAAAAAqAAAAcGFja2FnZS9zZXJ2aWNlcy9tZXRhZGF0YS9jb3JlLXByb3BlcnRpZXMvUEsDBBQAAAAIABN7eUJzhzbIAgEAANoBAABRAAAAcGFja2FnZS9zZXJ2aWNlcy9tZXRhZGF0YS9jb3JlLXByb3BlcnRpZXMvZWNmZGQzMTQzZjIxNDg5MDk1YTQ0YzcxMTE1YjcyM2IucHNtZGNwrZHNTsMwEIRfJfI9dpxA1FhJegBxAgmJSiBulrNJLeof2VtSno0Dj8QrkEZtEIgj55n5NLP7+f5Rrw9ml7xCiNrZhnCakQSscp22Q0P22Kcrsm5r5QLcB+choIaYTBkbRacaskX0gjG/DzvqwsA6xWAHBixGxilnZPEiBBP/DMzK4jxEvbjGcaRjMfvyLOPs6e72QW3ByFTbiNIqOKWWRJzlSKeqdlJ6F4zEOBO8VC9ygCOpZAZQdhIlOy5L/TKNtPWpqlABJEKXTIUEvnloyFl5LK6uNzekzTNepFmR5pcbXon8QhQVXZUlr8rquWa/ON9gM1231/9APoPamv18UPsFUEsDBBQAAAAAAMWFeUIAAAAAAAAAAAAAAAAJAAAAeGwvX3JlbHMvUEsDBBQAAAAIABN7eUInSnwy4gAAALwCAAAaAAAAeGwvX3JlbHMvd29ya2Jvb2sueG1sLnJlbHO1kkFOwzAQRa9izZ5MKKhCqG43bLqlvYDlTOKoiW15prQ9G4seqVfABAlhxIJNNrb8x/P0xvLt/branMdBvVHiPngN91UNirwNTe87DUdp755gs1690mAk32DXR1a5xbMGJxKfEdk6Gg1XIZLPlTak0Ug+pg6jsQfTES7qeonpJwNKptpfIv2HGNq2t/QS7HEkL3+AkZ1J1Owk5QkY1N6kjkQDnoeyVGUyqG2jIW2bB1A4n5FcBvqtMmWFw+OcDqeQDuyIpNT4jj/fLW+F0GJOIcm9VMpM0ddaeCwnDyz+4PoDUEsDBBQAAAAIABN7eUJ+UpEFfQAAAJAAAAAUAAAAeGwvc2hhcmVkU3RyaW5ncy54bWw9jEEOgyAQAL9C9l6hPTSNET34EoKrkshC2aXxbz30Sf1COfU4mcl8359hOuOhXlg4JLJw7QwoJJ+WQJuFKuvlAdM4nD2zKJ8qiYWWVArPivOf24S4Py3sIrnXmv2O0XGXMlJzayrRScOyac4F3cI7osRD34y56+gCgdLjD1BLAwQUAAAACAATe3lCItpbK1ACAAB6CAAADQAAAHhsL3N0eWxlcy54bWztVtuK2zAQ/RWh966S0JYS4iztFsPCsi3dFPZVsce2uroYSc7a+2t96Cf1F6qbnUuhJUspFJoXzRzNGc9NUr5//ba67AVHO9CGKZnh+cUMI5CFKpmsM9zZ6sUbfLle9UtjBw53DYBFjiHNss9wY227JMQUDQhqLlQL0u1VSgtqnaprYloNtDSeJjhZzGaviaBMYu9RdiIX1qBCddK6Tx+AKC7XZYZdPNHhlSohwxiR9YpMZE+plDz14iG/urzsW85qiXaUZ3hLDXAmIThxKT1FeD5PQKG40kjX2wzn+Sz80o6kAqLxFeVsq1nCKyoYH+LOYowtfj0JMUTG+RTiAo+QX1tqLWiZOxUleTO0LlOpUqBkb/xbUq3pMF+8OuYlIUSyVbp0zT4uVwRRyWitJOWf21D2UX2vHqUHvCWHyqIwCinAX5WNRHtvolndnEUMBG9jVXsOz5nHjKxV4hxiZHijMe9z2CMnufLlPBBD5Qvg/M57vK9ORqGvTuddTqLrWxKjq6TQtuXDbSe2oPNwOvaoHwrf2Ki9C6z9bjgNAuQB4aNWFgobz38IqJ0QxFXxAGXw17CyhDAJKem++in6+ct/K3xy3JexT3+iRX31V5KloxFqlGZPLi5/F9UgQVOO/c1uWREuvzDgGFno7SdlaXTiHD9q2m4cGBQmy/GDGrgz2sH1HvrSGcuq4YYae+Pu0YCZRjP5sFE5G2nUPx4fplzImT153kj9L/czy02mkT+6pU6eiAlH/inM8K0vLT8o+7Zj3DKZNHJ8tExQ938h1j8AUEsDBBQAAAAAAMWFeUIAAAAAAAAAAAAAAAAJAAAAeGwvdGhlbWUvUEsDBBQAAAAIABN7eUJ1sZFetwUAALsbAAASAAAAeGwvdGhlbWUvdGhlbWUueG1s7VlNbxtFGP4ro7236/VXnahuFTt2C23aKDFFPY7X491pZndWM+OkvqH2iISEKIgLEjcOCKjUShwo4scEiqBI+Qu8++HdHXs2cdsgiogP8c7s877P+72zzslPv1y9/jBg6JAISXnYtZzLNQuR0OUTGnpda6amlzrW9WtX8abySUAQgEO5ibuWr1S0advShW0sL/OIhHBvykWAFSyFZ08EPgIlAbPrtVrbDjANLRTigHStu9MpdQkaxSqtXPmAwZ9QyXjDZWLfTRjLEgl2cuDEX3Iu+0ygQ8y6FvBM+NGIPFQWYlgquNG1asnHQva1q3YuxVSFcElwmHwWgpnE5KCeCApvnEs6w+bGle2CoZ4yrAIHg0F/4BQaEwR2XfDWWQE3hx2nl2stodLLVe39WqvWXBIoMTRWBDZ6vV5rQxdoFALNFYFOrd3cqusCzUKgtepDb6vfb+sCrUKgvSIwvLLRbi4JJCif0fBgBR5ntkhRjplydtOI7wC+k9dCAbNLlZYqCFVV3QX4ARdDACRZxoqGSM0jMsUu4Po4GAuKEwa8SXDpVrbnytW9mA5JV9BIda33IwwNUmBOXnx38uIZOnnx9PjR8+NHPx4/fnz86AeT5E0cemXJV998+tdXH6E/n3396snnFQKyLPDb9x//+vNnFUhVRr784unvz5++/PKTP759YsJvCTwu40c0IBLdIUdojwexfwYKMhavKTLyMdVEsA9QE3KgfA15Z46ZEdgjegzvCRgLRuSN2QPN3n1fzBQ1IW/5gYbc4Zz1uDD7dCuhK/k0C70KfjErA/cwPjTS95eyPJhFUNnUqLTvE83UXQaJxx4JiULxPX5AiEnuPqVafHeoK7jkU4XuU9TD1ByYER0rs9RNGkCC5kYbIetahHbuoR5nRoJtcqhDoUMwMyolTIvmDTxTODBbjQNWht7Gyjcauj8XrhZ4qSDpHmEcDSZESqPQXTHXTL6FYUSZK2CHzQMdKhQ9MEJvY87L0G1+0PdxEJntpqFfBr8nD6BiMdrlymwH13smXkNCcFid+XuUaJlfo9k/oJ5mVVEs8Z2ZWEx1bT4HNDxtWDMK0/piWC8N6y14ghmbZHlEVwL/o4N5G8/CXRIX/8VcvpjLF3P5lA5fexoXA9hOVZRO2UHlIXtKGdtXc0Zuy2R0S7B7MoTNZJEI5Yf6yIfLBZ8G9AROrpHg6kOq/H0fR8DjJBSezHR7EkVcwsuEVak8vgHPDpXutfIXSoBjtcMn6X5De9PMFSUrT5apGrGKdekaV96WzkmRa/I5rQq+1ul8dimm0BsIx78cOO16ZqZ0MSOTOPqZhkV2zj1T0scTkqXKMfviNNaNXefs0JX4Nhpvy7dOrsqEzSrC1qmEayartpose7U7Waiv0BEY1qq3LOTiqGtN4eAFl0EECmU8kjDzwq7lqsybM3t72eeKAnVq1T5rJJGQahtLPxVLbi2kWFi4UG81Y3Xn44NpPq1pR6Pj/Kt22MsZJtMpcVXFTrHM7vGZImLfnxyhMZuJPQyWN9Mqm1AJj5L6YiGgX5tZAepzIOuH5Z9+sj7BLPJxNqM65QpI8cl1bkSyKtlnVxj/hr40ztEXrZr/b77E5QvH28YkvnThfCAwiuu0a3GhfA7zKPKpOxRwokjIwDAEvZGMLBb/hB0bSw5LIyxVkrQVHFHUHvWQoDD1lC8I2VWZp2docxYTMmuPTFM2cXKDZZR+j8khYaO4idtxCCzk52Mli0UCXE6cvs7iMfaG7/KpqJnHBb/WsaGgauaVsw5d+SFQejZsvK0Vr/kArle4XW+t/wCO4E0FxX9gkFPhsuIMPOJ7UAWI5YdOKMlLnawV880xWN0p+xfrSin+qTNWkYiCeCniWqOcY8QbFYT1MwjfPOItQ8C1ejLE215tWLv0ypOsVv7dxccPgHwb3qlmTMnURfIQ3k77i/9OgKKMMxG+9jdQSwMEFAAAAAgAE3t5QonecEYCAQAAuwEAAA8AAAB4bC93b3JrYm9vay54bWyNkE1uwjAQha9izb44RKKtIgybbthUlYratbHHxCK2I4+B3K2LHqlXqB2IQF115fn73rzxz9f3cj24jp0wkg1ewHxWAUOvgrZ+L+CYzMMzrFfLoTmHeNiFcGB53lMTBbQp9Q3npFp0kmahR597JkQnU07jngdjrMKXoI4OfeJ1VT3yiJ1MeRe1tie4qg3/UaM+otTUIibXXcSctB7u3b1Flr3jq3QoYNta+rw2gPEyV8IPi2e6h0qBGRspvRdxAfkPpEr2hFu5G7PM8j/w6OMWMT+uHAXYHNhY3GgBNbDY2BzEja4npRus0ViPuhimi0UlO1XOyE/h5/XiqV5M4GR59QtQSwMEFAAAAAAAxYV5QgAAAAAAAAAAAAAAAA4AAAB4bC93b3Jrc2hlZXRzL1BLAwQUAAAACAA2iHlCwUj1iNoBAACJAwAAFwAAAHhsL3dvcmtzaGVldHMvc2hlZXQueG1sjVNBbtswELwX6B8I3ms5BdwURuwgjRG0QAsbcdCeaWklEaa4xHJVOflaD31Sv9AVJdupT71pdqnZmVnyz6/fN7eHxqmfQNGiX+iryVQr8DkW1lcL3XL57qO+Xb59c3OYd0j7WAOwkl98nNNC18xhnmUxr6ExcYIBvPRKpMawQKoyLEubwwrztgHP2fvp9ENG4AzLuFjbEPXIdvgfthgITJFENG4ga4z1WgQqJRJTZ0MJpgK27KyHDanYNo2h50/gsBOf+lh4tFXNqZANLNm/NEJSWNHe56MIyoW+u5qvzsfH098tdPE891RTbHZbcJAzFAst4fYp7hD3ffPLULoYfKY6Ej2kCMREAaVpHT9i9xlG3bNLJSvDZnkiS2hsB7Ke1yFFr2ok+4KejbuXxQCN8uQmsM0virWELvchJlCRLb5KpvG1diE3FXwzVFnhdlCKtOnkWsTRoHMAjOH4uUNmbHo0GwYAjaBE5AFczy4GbIHboIIJQFv7AsMeRW3/NRU1/Zk1JaoCO/9Ug1+LI63ErBhKt05aQ4qiwZl8f+eLH7VlSHYKMkm6Vjk4d49Nf2vFqUcP8jCIkAQVNgZnnqF4JW+w8JC0n6uyfQcbQxxVjq3nU2b9gk4PavkXUEsBAhQAFAAAAAgAE3t5Qr1nXS45AQAANQQAABMAAAAAAAAAAQAAAAAAAAAAAFtDb250ZW50X1R5cGVzXS54bWxQSwECFAAUAAAACAATe3lCdJmAAx4BAACcAgAACwAAAAAAAAABAAAAAABqAQAAX3JlbHMvLnJlbHNQSwECFAAUAAAACAATe3lC717fXmEBAAA9AwAAEAAAAAAAAAABAAAAAACxAgAAZG9jUHJvcHMvYXBwLnhtbFBLAQIUABQAAAAAAMWFeUIAAAAAAAAAAAAAAAARAAAAAAAAAAAAEAAAAEAEAABwYWNrYWdlL3NlcnZpY2VzL1BLAQIUABQAAAAAAMWFeUIAAAAAAAAAAAAAAAAaAAAAAAAAAAAAEAAAAG8EAABwYWNrYWdlL3NlcnZpY2VzL21ldGFkYXRhL1BLAQIUABQAAAAAAMWFeUIAAAAAAAAAAAAAAAAqAAAAAAAAAAAAEAAAAKcEAABwYWNrYWdlL3NlcnZpY2VzL21ldGFkYXRhL2NvcmUtcHJvcGVydGllcy9QSwECFAAUAAAACAATe3lCc4c2yAIBAADaAQAAUQAAAAAAAAABAAAAAADvBAAAcGFja2FnZS9zZXJ2aWNlcy9tZXRhZGF0YS9jb3JlLXByb3BlcnRpZXMvZWNmZGQzMTQzZjIxNDg5MDk1YTQ0YzcxMTE1YjcyM2IucHNtZGNwUEsBAhQAFAAAAAAAxYV5QgAAAAAAAAAAAAAAAAkAAAAAAAAAAAAQAAAAYAYAAHhsL19yZWxzL1BLAQIUABQAAAAIABN7eUInSnwy4gAAALwCAAAaAAAAAAAAAAEAAAAAAIcGAAB4bC9fcmVscy93b3JrYm9vay54bWwucmVsc1BLAQIUABQAAAAIABN7eUJ+UpEFfQAAAJAAAAAUAAAAAAAAAAEAAAAAAKEHAAB4bC9zaGFyZWRTdHJpbmdzLnhtbFBLAQIUABQAAAAIABN7eUIi2lsrUAIAAHoIAAANAAAAAAAAAAEAAAAAAFAIAAB4bC9zdHlsZXMueG1sUEsBAhQAFAAAAAAAxYV5QgAAAAAAAAAAAAAAAAkAAAAAAAAAAAAQAAAAywoAAHhsL3RoZW1lL1BLAQIUABQAAAAIABN7eUJ1sZFetwUAALsbAAASAAAAAAAAAAEAAAAAAPIKAAB4bC90aGVtZS90aGVtZS54bWxQSwECFAAUAAAACAATe3lCid5wRgIBAAC7AQAADwAAAAAAAAABAAAAAADZEAAAeGwvd29ya2Jvb2sueG1sUEsBAhQAFAAAAAAAxYV5QgAAAAAAAAAAAAAAAA4AAAAAAAAAAAAQAAAACBIAAHhsL3dvcmtzaGVldHMvUEsBAhQAFAAAAAgANoh5QsFI9YjaAQAAiQMAABcAAAAAAAAAAQAgAAAANBIAAHhsL3dvcmtzaGVldHMvc2hlZXQueG1sUEsFBgAAAAAQABAARwQAAEMUAAAAAA==\";\nvar sheetFront = '<?xml version=\"1.0\" encoding=\"utf-8\"?><x:worksheet xmlns:ss=\"urn:schemas-microsoft-com:office:spreadsheet\" xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\" xmlns:x=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\" mc:Ignorable=\"x14ac\" xmlns:x14ac=\"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac\"><x:sheetPr><x:outlinePr summaryBelow=\"1\" summaryRight=\"1\" /></x:sheetPr><x:sheetViews><x:sheetView tabSelected=\"0\" workbookViewId=\"0\" /></x:sheetViews><x:sheetFormatPr defaultRowHeight=\"15\" />';\nvar sheetBack = '<x:printOptions horizontalCentered=\"0\" verticalCentered=\"0\" headings=\"0\" gridLines=\"0\" /><x:pageMargins left=\"0.75\" right=\"0.75\" top=\"0.75\" bottom=\"0.5\" header=\"0.5\" footer=\"0.75\" /><x:pageSetup paperSize=\"1\" scale=\"100\" pageOrder=\"downThenOver\" orientation=\"default\" blackAndWhite=\"0\" draft=\"0\" cellComments=\"none\" errors=\"displayed\" /><x:headerFooter /><x:tableParts count=\"0\" /></x:worksheet>';\nvar sharedStringsFront = '<?xml version=\"1.0\" encoding=\"UTF-8\"?><x:sst xmlns:x=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\" uniqueCount=\"$count\" count=\"$count\">';\nvar sharedStringsBack = '</x:sst>';\nvar shareStrings, convertedShareStrings;\nexports.executeAsync = function (config, callBack) {\n  return process.nextTick(function () {\n    var r = exports.execute(config);\n    callBack(r);\n  });\n};\nexports.execute = function (config) {\n  var cols = config.cols,\n    data = config.rows,\n    colsLength = cols.length,\n    xlsx = new JSZip(templateXLSX, {\n      base64: true,\n      checkCRC32: false\n    }),\n    sheet = xlsx.file(\"xl/worksheets/sheet.xml\"),\n    sharedStringsXml = xlsx.file(\"xl/sharedStrings.xml\"),\n    rows = \"\",\n    row = \"\",\n    colsWidth = \"\",\n    styleIndex,\n    k;\n  if (config.stylesXmlFile) {\n    var path = config.stylesXmlFile;\n    var styles = null;\n    styles = fs.readFileSync(path, 'utf8');\n    if (styles) {\n      xlsx.file(\"xl/styles.xml\", styles);\n    }\n  }\n  shareStrings = new Array();\n  convertedShareStrings = \"\";\n  //first row for column caption\n  row = '<x:row r=\"1\" spans=\"1:' + colsLength + '\">';\n  var colStyleIndex;\n  for (k = 0; k < colsLength; k++) {\n    colStyleIndex = cols[k].captionStyleIndex || 0;\n    row += addStringCol(getColumnLetter(k + 1) + 1, cols[k].caption, colStyleIndex);\n    if (cols[k].width) {\n      colsWidth += '<col customWidth = \"1\" width=\"' + cols[k].width + '\" max = \"' + (k + 1) + '\" min=\"' + (k + 1) + '\"/>';\n    }\n  }\n  row += '</x:row>';\n  rows += row;\n\n  //fill in data\n  var i,\n    j,\n    r,\n    cellData,\n    currRow,\n    cellType,\n    dataLength = data.length;\n  for (i = 0; i < dataLength; i++) {\n    r = data[i], currRow = i + 2;\n    row = '<x:row r=\"' + currRow + '\" spans=\"1:' + colsLength + '\">';\n    for (j = 0; j < colsLength; j++) {\n      styleIndex = null;\n      cellData = r[j];\n      cellType = cols[j].type;\n      if (typeof cols[j].beforeCellWrite === 'function') {\n        var e = {\n          rowNum: currRow,\n          styleIndex: null,\n          cellType: cellType\n        };\n        cellData = cols[j].beforeCellWrite(r, cellData, e);\n        styleIndex = e.styleIndex || styleIndex;\n        cellType = e.cellType;\n        delete e;\n      }\n      switch (cellType) {\n        case 'number':\n          row += addNumberCol(getColumnLetter(j + 1) + currRow, cellData, styleIndex);\n          break;\n        case 'date':\n          row += addDateCol(getColumnLetter(j + 1) + currRow, cellData, styleIndex);\n          break;\n        case 'bool':\n          row += addBoolCol(getColumnLetter(j + 1) + currRow, cellData, styleIndex);\n          break;\n        default:\n          row += addStringCol(getColumnLetter(j + 1) + currRow, cellData, styleIndex);\n      }\n    }\n    row += '</x:row>';\n    rows += row;\n  }\n  if (colsWidth !== \"\") sheetFront += '<cols>' + colsWidth + '</cols>';\n  xlsx.file(sheet.name, sheetFront + '<x:sheetData>' + rows + '</x:sheetData>' + sheetBack);\n  if (shareStrings.length > 0) {\n    sharedStringsFront = sharedStringsFront.replace(/\\$count/g, shareStrings.length);\n    xlsx.file(sharedStringsXml.name, sharedStringsFront + convertedShareStrings + sharedStringsBack);\n  }\n  var results = xlsx.generate({\n    base64: false,\n    compression: \"DEFLATE\"\n  });\n  delete xlsx;\n  delete shareStrings;\n  return results;\n};\nvar startTag = function (obj, tagName, closed) {\n  var result = \"<\" + tagName,\n    p;\n  for (p in obj) {\n    result += \" \" + p + \"=\" + obj[p];\n  }\n  if (!closed) result += \">\";else result += \"/>\";\n  return result;\n};\nvar endTag = function (tagName) {\n  return \"</\" + tagName + \">\";\n};\nvar addNumberCol = function (cellRef, value, styleIndex) {\n  styleIndex = styleIndex || 0;\n  if (value === null) return \"\";else return '<x:c r=\"' + cellRef + '\" s=\"' + styleIndex + '\" t=\"n\"><x:v>' + value + '</x:v></x:c>';\n};\nvar addDateCol = function (cellRef, value, styleIndex) {\n  styleIndex = styleIndex || 1;\n  if (value === null) return \"\";else return '<x:c r=\"' + cellRef + '\" s=\"' + styleIndex + '\" t=\"n\"><x:v>' + value + '</x:v></x:c>';\n};\nvar addBoolCol = function (cellRef, value, styleIndex) {\n  styleIndex = styleIndex || 0;\n  if (value === null) return \"\";\n  if (value) {\n    value = 1;\n  } else value = 0;\n  return '<x:c r=\"' + cellRef + '\" s=\"' + styleIndex + '\" t=\"b\"><x:v>' + value + '</x:v></x:c>';\n};\nvar addStringCol = function (cellRef, value, styleIndex) {\n  styleIndex = styleIndex || 0;\n  if (value === null) return \"\";\n  if (typeof value === 'string') {\n    value = value.replace(/&/g, \"&amp;\").replace(/'/g, \"&apos;\").replace(/>/g, \"&gt;\").replace(/</g, \"&lt;\");\n  }\n  var i = shareStrings.indexOf(value);\n  if (i < 0) {\n    i = shareStrings.push(value) - 1;\n    convertedShareStrings = convertedShareStrings + \"<x:si><x:t>\" + value + \"</x:t></x:si>\";\n  }\n  return '<x:c r=\"' + cellRef + '\" s=\"' + styleIndex + '\" t=\"s\"><x:v>' + i + '</x:v></x:c>';\n};\nvar getColumnLetter = function (col) {\n  if (col <= 0) throw \"col must be more than 0\";\n  var array = new Array();\n  while (col > 0) {\n    var remainder = col % 26;\n    col /= 26;\n    col = Math.floor(col);\n    if (remainder === 0) {\n      remainder = 26;\n      col--;\n    }\n    array.push(64 + remainder);\n  }\n  return String.fromCharCode.apply(null, array.reverse());\n};","map":{"version":3,"names":["require","fs","Date","prototype","getJulian","Math","floor","getTimezoneOffset","oaDate","UTC","templateXLSX","sheetFront","sheetBack","sharedStringsFront","sharedStringsBack","shareStrings","convertedShareStrings","exports","executeAsync","config","callBack","process","nextTick","r","execute","cols","data","rows","colsLength","length","xlsx","JSZip","base64","checkCRC32","sheet","file","sharedStringsXml","row","colsWidth","styleIndex","k","stylesXmlFile","path","styles","readFileSync","Array","colStyleIndex","captionStyleIndex","addStringCol","getColumnLetter","caption","width","i","j","cellData","currRow","cellType","dataLength","type","beforeCellWrite","e","rowNum","addNumberCol","addDateCol","addBoolCol","name","replace","results","generate","compression","startTag","obj","tagName","closed","result","p","endTag","cellRef","value","indexOf","push","col","array","remainder","String","fromCharCode","apply","reverse"],"sources":["/Users/milenmladenov/asset-management-fe/node_modules/excel-export/index.js"],"sourcesContent":["require('node-zip');\r\nvar fs = require('fs');\r\n\r\nDate.prototype.getJulian = function() {\r\n\treturn Math.floor((this / 86400000) -\r\n\t(this.getTimezoneOffset()/1440) + 2440587.5);\r\n};\r\n\r\nDate.prototype.oaDate = function() {\r\n return (this - new Date(Date.UTC(1899,11,30))) / (24 * 60 * 60 * 1000);\r\n};\r\n\r\nvar templateXLSX = \"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\";\r\nvar sheetFront = '<?xml version=\"1.0\" encoding=\"utf-8\"?><x:worksheet xmlns:ss=\"urn:schemas-microsoft-com:office:spreadsheet\" xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\" xmlns:x=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\" mc:Ignorable=\"x14ac\" xmlns:x14ac=\"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac\"><x:sheetPr><x:outlinePr summaryBelow=\"1\" summaryRight=\"1\" /></x:sheetPr><x:sheetViews><x:sheetView tabSelected=\"0\" workbookViewId=\"0\" /></x:sheetViews><x:sheetFormatPr defaultRowHeight=\"15\" />';\r\nvar sheetBack = '<x:printOptions horizontalCentered=\"0\" verticalCentered=\"0\" headings=\"0\" gridLines=\"0\" /><x:pageMargins left=\"0.75\" right=\"0.75\" top=\"0.75\" bottom=\"0.5\" header=\"0.5\" footer=\"0.75\" /><x:pageSetup paperSize=\"1\" scale=\"100\" pageOrder=\"downThenOver\" orientation=\"default\" blackAndWhite=\"0\" draft=\"0\" cellComments=\"none\" errors=\"displayed\" /><x:headerFooter /><x:tableParts count=\"0\" /></x:worksheet>';\r\n\r\n\r\nvar sharedStringsFront = '<?xml version=\"1.0\" encoding=\"UTF-8\"?><x:sst xmlns:x=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\" uniqueCount=\"$count\" count=\"$count\">';\r\nvar sharedStringsBack = '</x:sst>';\r\nvar shareStrings, convertedShareStrings;\r\n\r\nexports.executeAsync = function(config, callBack){\r\n\treturn process.nextTick(function(){\r\n\t\tvar r = exports.execute(config);\t\t\r\n\t\tcallBack(r);\r\n\t});\r\n};\r\n\r\nexports.execute = function(config){\r\n\tvar cols = config.cols,\r\n\t\tdata = config.rows,\r\n    colsLength = cols.length,\r\n\t  xlsx = new JSZip(templateXLSX, { base64: true, checkCRC32: false }),\r\n\t\tsheet = xlsx.file(\"xl/worksheets/sheet.xml\"),\r\n\t\tsharedStringsXml = xlsx.file(\"xl/sharedStrings.xml\"),\r\n\t\trows = \"\",\r\n\t\trow =\"\",\r\n    colsWidth = \"\",\r\n    styleIndex,\r\n    k;\r\n\r\n  if (config.stylesXmlFile){\r\n    var path = config.stylesXmlFile;\r\n    var styles = null;\r\n    styles = fs.readFileSync(path, 'utf8');\r\n    if (styles){\r\n      xlsx.file(\"xl/styles.xml\", styles);\r\n    }\r\n  }\r\n  \r\n\tshareStrings = new Array();\r\n  convertedShareStrings = \"\";\r\n\t//first row for column caption\r\n\trow = '<x:row r=\"1\" spans=\"1:'+ colsLength + '\">';\r\n  var colStyleIndex;\r\n\tfor (k=0; k < colsLength; k++)\r\n\t{\r\n    colStyleIndex = cols[k].captionStyleIndex || 0;\r\n\t\trow += addStringCol(getColumnLetter(k+1)+1, cols[k].caption, colStyleIndex);\r\n    if (cols[k].width){\r\n      colsWidth += '<col customWidth = \"1\" width=\"' + cols[k].width + '\" max = \"' + (k+1) +'\" min=\"' + (k+1) +'\"/>';\r\n    }\r\n\t}\r\n\trow += '</x:row>';\r\n\trows += row;\t\r\n\t\r\n\t//fill in data\r\n  var i, j, r, cellData, currRow, cellType,\r\n    dataLength = data.length;\r\n    \r\n\tfor (i=0;i<dataLength;i++)\r\n\t{\r\n\t\tr = data[i], currRow = i+2;\r\n\t\trow = '<x:row r=\"' + currRow +'\" spans=\"1:'+ colsLength + '\">';\r\n\t\tfor (j=0; j < colsLength; j++)\r\n\t\t{\r\n      styleIndex = null;\r\n      cellData = r[j];\r\n      cellType = cols[j].type;\r\n      if (typeof cols[j].beforeCellWrite === 'function'){\r\n        var e ={rowNum: currRow, styleIndex: null, cellType: cellType};\r\n        cellData = cols[j].beforeCellWrite(r, cellData, e);\r\n        styleIndex = e.styleIndex || styleIndex;\r\n        cellType = e.cellType;\r\n        delete e;\r\n      }     \r\n\t\t\tswitch(cellType)\r\n\t\t\t{\r\n\t\t\t\tcase 'number':\r\n\t\t\t\t\trow += addNumberCol(getColumnLetter(j+1)+currRow, cellData, styleIndex);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'date':\r\n\t\t\t\t\trow += addDateCol(getColumnLetter(j+1)+currRow, cellData, styleIndex);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'bool':\r\n\t\t\t\t\trow += addBoolCol(getColumnLetter(j+1)+currRow, cellData, styleIndex);\r\n\t\t\t\t\tbreak;\t\t\t\t\t\r\n\t\t\t\tdefault:\r\n\t\t\t\t\trow += addStringCol(getColumnLetter(j+1)+currRow, cellData, styleIndex);\r\n\t\t\t}\r\n\t\t}\r\n\t\trow += '</x:row>';\r\n\t\trows += row;\r\n\t}\t\r\n  if (colsWidth !== \"\")\r\n    sheetFront += '<cols>'+colsWidth+'</cols>';\r\n\txlsx.file(sheet.name, sheetFront + '<x:sheetData>' + rows + '</x:sheetData>' + sheetBack);\r\n  \r\n  \r\n\tif (shareStrings.length >0)\r\n\t{\r\n\t\tsharedStringsFront = sharedStringsFront.replace(/\\$count/g, shareStrings.length);\r\n\t\txlsx.file(sharedStringsXml.name, (sharedStringsFront + convertedShareStrings + sharedStringsBack));\r\n\t}\r\n\tvar results = xlsx.generate({ base64: false, compression: \"DEFLATE\" });\r\n\tdelete xlsx;\r\n\tdelete shareStrings;\r\n\treturn results;\r\n};\r\n\r\nvar startTag = function (obj, tagName, closed){\r\n  var result = \"<\" + tagName, p;\r\n  for (p in obj){\r\n    result += \" \" + p + \"=\" + obj[p];\r\n  }\r\n  if (!closed)\r\n    result += \">\";\r\n  else\r\n    result += \"/>\";\r\n  return result;\r\n};\r\n\r\nvar endTag = function(tagName){\r\n  return \"</\" + tagName + \">\";\r\n};\r\n\r\nvar addNumberCol = function(cellRef, value, styleIndex){\r\n  styleIndex = styleIndex || 0;\r\n\tif (value===null)\r\n\t\treturn \"\";\r\n\telse\r\n\t\treturn '<x:c r=\"'+cellRef+'\" s=\"'+ styleIndex +'\" t=\"n\"><x:v>'+value+'</x:v></x:c>';\r\n};\r\n\r\nvar addDateCol = function(cellRef, value, styleIndex){\r\n  styleIndex = styleIndex || 1;\r\n\tif (value===null)\r\n\t\treturn \"\";\r\n\telse\r\n\t\treturn '<x:c r=\"'+cellRef+'\" s=\"'+ styleIndex +'\" t=\"n\"><x:v>'+value+'</x:v></x:c>';\r\n};\r\n\r\nvar addBoolCol = function(cellRef, value, styleIndex){\r\n  styleIndex = styleIndex || 0;\r\n\tif (value===null)\r\n\t\treturn \"\";\r\n\tif (value){\r\n\t  value = 1;\r\n\t} else\r\n\t  value = 0;\r\n\treturn '<x:c r=\"'+cellRef+'\" s=\"'+ styleIndex + '\" t=\"b\"><x:v>'+value+'</x:v></x:c>';\r\n};\r\nvar addStringCol = function(cellRef, value, styleIndex){\r\n  styleIndex = styleIndex || 0;\r\n\tif (value===null)\r\n\t\treturn \"\";\r\n  if (typeof value ==='string'){\r\n    value = value.replace(/&/g, \"&amp;\").replace(/'/g, \"&apos;\").replace(/>/g, \"&gt;\").replace(/</g, \"&lt;\");\r\n  }\r\n  var i = shareStrings.indexOf(value);\r\n\tif ( i< 0){\r\n\t\ti = shareStrings.push(value) -1;\r\n    convertedShareStrings = convertedShareStrings+ \"<x:si><x:t>\"+value+\"</x:t></x:si>\";\r\n\t}\r\n\treturn '<x:c r=\"'+cellRef+'\" s=\"'+ styleIndex + '\" t=\"s\"><x:v>'+i+'</x:v></x:c>';\r\n};\r\n\r\nvar getColumnLetter = function(col){\r\n  if (col <= 0)\r\n\tthrow \"col must be more than 0\";\r\n  var array = new Array();\r\n  while (col > 0)\r\n  {\r\n\tvar remainder = col % 26;\r\n\tcol /= 26;\r\n\tcol = Math.floor(col);\r\n\tif(remainder ===0)\r\n\t{\r\n\t\tremainder = 26;\r\n\t\tcol--;\r\n\t}\r\n\tarray.push(64 + remainder);\r\n  }\r\n  return String.fromCharCode.apply(null, array.reverse());\r\n};"],"mappings":"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"},"metadata":{},"sourceType":"script"}