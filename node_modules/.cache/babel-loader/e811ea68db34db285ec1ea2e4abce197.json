{"ast":null,"code":"var _jsxFileName = \"/Users/milenmladenov/asset-management-fe/src/pages/newExcelOrderForm.js\";\nimport React, { useState } from 'react';\nimport * as XLSX from 'xlsx';\nimport NewOrderForm from './newOrderForm';\nimport PageTitle from \"../components/Typography/PageTitle\";\nconst NewExcelOrderForm = () => {\n  const [groupForms, setGroupForms] = useState([]);\n  const handleChange = (event, index) => {\n    const {\n      name,\n      value\n    } = event.target;\n    const updatedGroupForms = [...groupForms];\n    updatedGroupForms[index] = {\n      ...updatedGroupForms[index],\n      [name]: value\n    };\n    setGroupForms(updatedGroupForms);\n  };\n  const handleAddGroup = () => {\n    setGroupForms(prevGroupForms => [...prevGroupForms, {/* Initial form data for the new group */}]);\n  };\n  const handleFileChange = event => {\n    const file = event.target.files[0];\n    const reader = new FileReader();\n    reader.onload = e => {\n      const data = new Uint8Array(e.target.result);\n      const workbook = XLSX.read(data, {\n        type: 'array'\n      });\n      const worksheet = workbook.Sheets[workbook.SheetNames[0]];\n      const excelData = XLSX.utils.sheet_to_json(worksheet, {\n        header: 1\n      });\n\n      // Assuming the headers are in the order: 'Модел', 'Фолио', 'Височина', 'Ширина', 'Брой', 'м2', 'Профил', 'Дръжка'\n      const [Модел, folioHeader, heightHeader, widthHeader, quantityHeader, areaHeader, profilHeader, handleHeader] = excelData[0];\n      const formData = excelData.slice(1).map(row => ({\n        modelName: row[Модел],\n        folioName: row[folioHeader],\n        height: row[heightHeader],\n        width: row[widthHeader],\n        number: row[quantityHeader],\n        area: row[areaHeader],\n        profilName: row[profilHeader],\n        handleName: row[handleHeader]\n      }));\n      setGroupForms(formData); // Update the groupForms state with the imported data\n    };\n\n    reader.readAsArrayBuffer(file);\n  };\n  const handleImportButtonClick = () => {\n    // Check if there are any rows in the imported data\n    if (groupForms.length > 0) {\n      // If there is more than one row, create new groups\n      const newGroups = groupForms.map(formData => ({\n        ...formData\n      }));\n      setGroupForms(prevGroupForms => [...prevGroupForms, ...newGroups]);\n    }\n  };\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"col-span-2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 57,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    htmlFor: \"fileInput\",\n    className: \"block font-medium\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 58,\n      columnNumber: 9\n    }\n  }, \"\\u0418\\u043C\\u043F\\u043E\\u0440\\u0442\\u0438\\u0440\\u0430\\u043D\\u0435 \\u043D\\u0430 Excel \\u0444\\u0430\\u0439\\u043B:\"), /*#__PURE__*/React.createElement(\"input\", {\n    type: \"file\",\n    id: \"fileInput\",\n    name: \"fileInput\",\n    onChange: handleFileChange,\n    accept: \".xlsx, .xls\",\n    className: \"mt-1\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 61,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(\"button\", {\n    className: \"px-4 py-2 mt-2 text-white bg-blue-600 rounded-md shadow-md hover:bg-blue-700\",\n    onClick: handleImportButtonClick,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 69,\n      columnNumber: 9\n    }\n  }, \"\\u0418\\u043C\\u043F\\u043E\\u0440\\u0442\\u0438\\u0440\\u0430\\u0439\")), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"grid gap-2 mb-12 md:grid-cols-2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"col-span-12 text-center\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 77,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(PageTitle, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 78,\n      columnNumber: 11\n    }\n  }, \"\\u0421\\u044A\\u0437\\u0434\\u0430\\u0432\\u0430\\u043D\\u0435 \\u043D\\u0430 \\u043D\\u043E\\u0432\\u0430 \\u043F\\u043E\\u0440\\u044A\\u0447\\u043A\\u0430\")), groupForms.map((formData, index) => /*#__PURE__*/React.createElement(\"div\", {\n    key: index,\n    className: \"col-span-2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"form\", {\n    id: `orderForm${index}`,\n    className: \"grid grid-cols-2 gap-4 border\",\n    style: {\n      padding: '20px'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 82,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    htmlFor: \"modelName\",\n    className: \"block font-medium\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 89,\n      columnNumber: 17\n    }\n  }, \"\\u041C\\u043E\\u0434\\u0435\\u043B:\"), /*#__PURE__*/React.createElement(\"select\", {\n    className: \"mt-1 w-full p-2 border rounded-md shadow-sm\",\n    id: \"modelName\",\n    name: \"modelName\",\n    value: formData.modelName,\n    onChange: event => handleChange(event, index),\n    disabled: formData.doorName === '',\n    required: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 17\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"col-span-2 flex justify-end\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 109,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    className: \"w-full px-4 py-2 text-white bg-green-600 rounded-md shadow-md hover:bg-green-700\",\n    onClick: handleAddGroup,\n    style: {\n      width: '150px',\n      margin: '10px'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 110,\n      columnNumber: 17\n    }\n  }, \"\\u041D\\u043E\\u0432\\u0430 \\u0413\\u0440\\u0443\\u043F\\u0430\")))))));\n};\nexport default NewExcelOrderForm;","map":{"version":3,"names":["React","useState","XLSX","NewOrderForm","PageTitle","NewExcelOrderForm","groupForms","setGroupForms","handleChange","event","index","name","value","target","updatedGroupForms","handleAddGroup","prevGroupForms","handleFileChange","file","files","reader","FileReader","onload","e","data","Uint8Array","result","workbook","read","type","worksheet","Sheets","SheetNames","excelData","utils","sheet_to_json","header","Модел","folioHeader","heightHeader","widthHeader","quantityHeader","areaHeader","profilHeader","handleHeader","formData","slice","map","row","modelName","folioName","height","width","number","area","profilName","handleName","readAsArrayBuffer","handleImportButtonClick","length","newGroups","createElement","Fragment","className","__self","__source","fileName","_jsxFileName","lineNumber","columnNumber","htmlFor","id","onChange","accept","onClick","key","style","padding","disabled","doorName","required","margin"],"sources":["/Users/milenmladenov/asset-management-fe/src/pages/newExcelOrderForm.js"],"sourcesContent":["import React, { useState } from 'react';\nimport * as XLSX from 'xlsx';\nimport NewOrderForm from './newOrderForm';\nimport PageTitle from \"../components/Typography/PageTitle\";\n\n\nconst NewExcelOrderForm = () => {\n  const [groupForms, setGroupForms] = useState([]);\n\n  const handleChange = (event, index) => {\n    const { name, value } = event.target;\n    const updatedGroupForms = [...groupForms];\n    updatedGroupForms[index] = { ...updatedGroupForms[index], [name]: value };\n    setGroupForms(updatedGroupForms);\n  };\n  const handleAddGroup = () => {\n    setGroupForms((prevGroupForms) => [...prevGroupForms, { /* Initial form data for the new group */ }]);\n  };\n  const handleFileChange = (event) => {\n    const file = event.target.files[0];\n    const reader = new FileReader();\n    reader.onload = (e) => {\n      const data = new Uint8Array(e.target.result);\n      const workbook = XLSX.read(data, { type: 'array' });\n      const worksheet = workbook.Sheets[workbook.SheetNames[0]];\n      const excelData = XLSX.utils.sheet_to_json(worksheet, { header: 1 });\n\n      // Assuming the headers are in the order: 'Модел', 'Фолио', 'Височина', 'Ширина', 'Брой', 'м2', 'Профил', 'Дръжка'\n      const [Модел, folioHeader, heightHeader, widthHeader, quantityHeader, areaHeader, profilHeader, handleHeader] = excelData[0];\n      const formData = excelData.slice(1).map((row) => ({\n        modelName: row[Модел],\n        folioName: row[folioHeader],\n        height: row[heightHeader],\n        width: row[widthHeader],\n        number: row[quantityHeader],\n        area: row[areaHeader],\n        profilName: row[profilHeader],\n        handleName: row[handleHeader],\n      }));\n\n      setGroupForms(formData); // Update the groupForms state with the imported data\n    };\n    reader.readAsArrayBuffer(file);\n  };\n\n  const handleImportButtonClick = () => {\n    // Check if there are any rows in the imported data\n    if (groupForms.length > 0) {\n      // If there is more than one row, create new groups\n      const newGroups = groupForms.map((formData) => ({ ...formData }));\n      setGroupForms((prevGroupForms) => [...prevGroupForms, ...newGroups]);\n    }\n  };\n\n  return (\n    <>\n      <div className=\"col-span-2\">\n        <label htmlFor=\"fileInput\" className=\"block font-medium\">\n          Импортиране на Excel файл:\n        </label>\n        <input\n          type=\"file\"\n          id=\"fileInput\"\n          name=\"fileInput\"\n          onChange={handleFileChange}\n          accept=\".xlsx, .xls\"\n          className=\"mt-1\"\n        />\n        <button\n          className=\"px-4 py-2 mt-2 text-white bg-blue-600 rounded-md shadow-md hover:bg-blue-700\"\n          onClick={handleImportButtonClick}\n        >\n          Импортирай\n        </button>\n      </div>\n      <div className=\"grid gap-2 mb-12 md:grid-cols-2\">\n        <div className=\"col-span-12 text-center\">\n          <PageTitle>Създаване на нова поръчка</PageTitle>\n        </div>\n        {groupForms.map((formData, index) => (\n          <div key={index} className=\"col-span-2\">\n            <form\n              id={`orderForm${index}`}\n              className=\"grid grid-cols-2 gap-4 border\"\n              style={{ padding: '20px' }}\n            >\n              {/* Model Name */}\n              <div>\n                <label htmlFor=\"modelName\" className=\"block font-medium\">\n                  Модел:\n                </label>\n                <select\n                  className=\"mt-1 w-full p-2 border rounded-md shadow-sm\"\n                  id=\"modelName\"\n                  name=\"modelName\"\n                  value={formData.modelName}\n                  onChange={(event) => handleChange(event, index)}\n                  disabled={formData.doorName === ''}\n                  required\n                >\n                  {/* Add options for Model Name */}\n                </select>\n              </div>\n\n              {/* The rest of the form fields... */}\n              {/* Replace this section with the remaining form fields */}\n              {/* For example, you can have similar sections for Folio Name, Handle Name, Profil Name, Height, Width, Number, etc. */}\n\n              <div className=\"col-span-2 flex justify-end\">\n                <button\n                  className=\"w-full px-4 py-2 text-white bg-green-600 rounded-md shadow-md hover:bg-green-700\"\n                  onClick={handleAddGroup}\n                  style={{ width: '150px', margin: '10px' }}\n                >\n                  Нова Група\n                </button>\n              </div>\n            </form>\n          </div>\n        ))}\n      </div>\n    </>\n  );\n};\n\nexport default NewExcelOrderForm;"],"mappings":"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"},"metadata":{},"sourceType":"module"}